<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="../../../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../../../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../../../bower_components/paper-icon-button/paper-icon-button.html">

<link rel="import" href="../../../src/util/hass-util.html">
<link rel="import" href="../../../src/resources/ha-style.html">
<link rel="import" href="../../../src/components/ha-card.html">

<dom-module id="ha-config-adv-entity-list">
  <template>
    <style include="ha-style">
    </style>

    <app-header-layout has-scrolling-region>
      <app-header slot="header" fixed>
        <app-toolbar>
          <paper-icon-button
            icon='mdi:arrow-left'
            on-tap='_backTapped'
          ></paper-icon-button>
          <div main-title>Entity List</div>
        </app-toolbar>
      </app-header>

      <div class$='[[computeClasses(isWide)]]'>
        <template is='dom-repeat' items='[[entities]]' as='entity'>
          <ha-card>
            <div class='header horizontal layout center' on-tap='entityTapped'>
              <a href='#'>[[entity.entity_id]]</a>
              <div>[[entity.state]]？？？？？</div>
              <div>[[attributeString(entity)]]</div>
            </div>
          </ha-card>
        </template>
      </div>
    </app-header-layout>
  </template>
</dom-module>

<script>
class HaConfigAdvEntityList extends Polymer.Element {
  static get is() { return 'ha-config-adv-entity-list'; }

  static get properties() {
    return {
      hass: Object,
      isWide: Boolean,

      entities: {
        type: Array,
        computed: 'computeEntities(hass)',
      }
      // ,

      // entityConfig: {
      //   type: Object,
      //   value: {
      //     component: 'ha-form-customize',
      //     computeSelectCaption: stateObj =>
      //       window.hassUtil.computeStateName(stateObj) + ' (' + window.hassUtil.computeDomain(stateObj) + ')'
      //   }
      // },
    };
  }

  computeClasses(isWide) {
    return isWide ? 'content' : 'content narrow';
  }

  _backTapped() {
    history.back();
  }

  computeEntities(hass) {
    return Object.keys(hass.states)
      .map(key => hass.states[key])
      .sort(window.hassUtil.sortByName);
  }

  entityTapped(ev) {
  	alert(3);
  }
}
customElements.define(HaConfigAdvEntityList.is, HaConfigAdvEntityList);
</script>
